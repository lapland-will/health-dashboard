# 每日健康报告自动发送系统

**设置时间：** 2025-01-31
**用户：** 金明
**发送时间：** 每天上午11点

---

## 📋 系统功能

自动功能：
- ✓ 每天上午11点自动同步Oura Ring数据
- ✓ 生成完整的每日健康报告
- ✓ 包含训练建议（针对自由潜水运动员）
- ✓ 补剂提醒（含异维A酸隔日疗法提醒）
- ✓ 保存Markdown和JSON格式报告

---

## 🚀 快速开始

### 一次性设置（仅需操作一次）

```bash
cd ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health
./setup_daily_report.sh
```

设置完成后，系统会自动在每天上午11点运行。

---

## 📁 文件说明

### 核心脚本

| 文件 | 功能 |
|------|------|
| `setup_daily_report.sh` | **设置定时任务（运行一次即可）** |
| `daily_oura_report.sh` | 每日报告主脚本（自动调用） |
| `daily_health_report.py` | 生成健康报告的Python脚本 |

### 数据目录

| 目录 | 内容 |
|------|------|
| `DailyReports/` | 每日健康报告（Markdown + JSON） |
| `OuraData/` | Oura Ring原始数据 |

---

## 📊 报告内容

### 每日报告包含：

#### 1. 健康评分
- 准备度 (Readiness) - 综合评估
- 睡眠质量 - 睡眠时长、深度睡眠、REM
- 活动数据 - 步数、卡路里、距离
- HRV数据 - 心率变异性分析

#### 2. 训练建议
基于准备度分数：
- ⭐ 85+ → 高强度训练
- ✓ 70-84 → 中等强度训练
- ⚠️ 55-69 → 低强度训练
- ❌ <55 → 建议休息

#### 3. 补剂提醒
- 异维A酸隔日疗法提醒
- NMN、益生菌、鱼油等
- 根据活动数据调整肌酸

---

## 🧪 测试系统

### 手动测试（立即运行）

```bash
cd ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health
./daily_oura_report.sh
```

### 查看定时任务

```bash
crontab -l
```

应该看到类似：
```
0 11 * * * cd /path/to/Personal/Health && ./daily_oura_report.sh >> /path/to/Personal/Health/cron.log 2>&1
```

### 查看运行日志

```bash
tail -f ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health/cron.log
```

---

## 🔧 配置选项

### 修改发送时间

编辑 `setup_daily_report.sh` 中的时间：

```bash
# 当前：每天上午11点
CRON_JOB="0 11 * * * ..."

# 改为上午9点：
CRON_JOB="0 9 * * * ..."

# 改为下午6点：
CRON_JOB="0 18 * * * ..."
```

然后重新运行 `./setup_daily_report.sh`

### 添加邮件发送（可选）

在 `daily_oura_report.sh` 中取消注释：

```bash
# 设置邮箱
EMAIL="your-email@example.com"

# 发送邮件
mail -s "金明 - 今日健康报告 ($TODAY)" "$EMAIL" < "$REPORT_FILE"
```

---

## 📱 如何查看报告

### 方式1：查看生成的文件

```bash
cd ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health/DailyReports
cat daily_report_$(date +%Y-%m-%d).md
```

### 方式2：Obsidian打开

报告会自动保存在：
```
Personal/Health/DailyReports/daily_report_YYYY-MM-DD.md
```

在Obsidian中打开查看即可。

### 方式3：终端显示（默认）

脚本运行时会自动在终端显示报告内容。

---

## ❓ 常见问题

### Q1: 为什么今天没有收到报告？

**A:** 检查以下几点：

1. 确认定时任务已设置：
```bash
crontab -l | grep daily_oura_report
```

2. 检查日志文件：
```bash
tail -50 ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health/cron.log
```

3. 手动测试：
```bash
cd ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health
./daily_oura_report.sh
```

### Q2: 如何停止每日报告？

```bash
# 编辑crontab
crontab -e

# 删除包含 daily_oura_report 的行
```

或运行：
```bash
crontab -l | grep -v "daily_oura_report" | crontab -
```

### Q3: 如何更换报告发送时间？

1. 删除旧任务：
```bash
crontab -l | grep -v "daily_oura_report" | crontab -
```

2. 编辑 `setup_daily_report.sh`，修改时间

3. 重新运行：
```bash
./setup_daily_report.sh
```

### Q4: Oura API token失效怎么办？

1. 获取新的token：https://cloud.ouraring.com/oauth/personal_access_token

2. 更新 `daily_health_report.py` 中的：
```python
ACCESS_TOKEN = "YOUR_NEW_TOKEN"
```

---

## 📝 报告示例

```markdown
# 金明 - 今日健康报告

**日期：** 2025-01-31
**生成时间：** 2025-01-31 11:00:00

---

## 📊 今日健康评分

### 准备度 (Readiness)

**分数：** 85/100 ⭐

| 指标 | 数值 |
|------|------|
| HRV平衡 | 87/100 |
| 恢复指数 | 92/100 |
| 静息心率 | 85/100 |

### 睡眠质量

**分数：** 82/100

| 指标 | 数值 |
|------|------|
| 总睡眠时长 | 7.5 小时 |
| 深度睡眠 | 1.2 小时 (16%) |
| 快速眼动睡眠 | 1.9 小时 (25%) |

### 活动数据

**分数：** 89/100

| 指标 | 数值 |
|------|------|
| 步数 | 8,532 步 |
| 总消耗 | 2,450 千卡 |

---

## 🎯 自由潜水训练建议

### ✓ 高强度

**准备度 85/100 - 状态优秀**

可以进行高强度闭气训练、深度挑战、技术精练

---

## 💊 补剂提醒

**今日补剂：**

- ☑ 异维A酸 10mg（今日服药日）
- ☑ NMN22000 1粒
- ☑ 益生菌
- ☑ 鱼油
- ☑ 镁（睡前）
- ☑ 维生素D3
- ☑ 肌酸 3g（今日有活动）

---

*报告生成时间：2025-01-31 11:00:00*
*数据来源：Oura Ring Gen 3*
```

---

## 🎯 下一步

1. **立即测试**
```bash
cd ~/Desktop/AI/QuantTrading/QuantTrading/Personal/Health
./daily_oura_report.sh
```

2. **确认报告内容正确**

3. **设置定时任务**
```bash
./setup_daily_report.sh
```

4. **明天上午11点接收第一份自动报告**

---

*系统设置时间：2025-01-31*
*首次运行：明天上午11:00*
